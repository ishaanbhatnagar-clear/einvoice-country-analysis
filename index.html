<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global E-Invoicing Country Analysis</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif; line-height: 1.6; color: #333; background: #f5f7fa; padding: 20px; }
        .container { max-width: 1600px; margin: 0 auto; }
        h1 { color: #1a365d; margin-bottom: 10px; font-size: 2.2em; }
        h2 { color: #2d3748; margin: 30px 0 15px; padding-bottom: 10px; border-bottom: 2px solid #4299e1; }
        h3 { color: #4a5568; margin: 20px 0 10px; }
        .subtitle { color: #718096; margin-bottom: 30px; }

        /* Navigation */
        .main-nav { display: flex; gap: 10px; margin-bottom: 25px; flex-wrap: wrap; background: white; padding: 15px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
        .nav-btn { padding: 12px 24px; border: 2px solid #e2e8f0; border-radius: 25px; background: white; cursor: pointer; font-size: 0.95em; font-weight: 600; transition: all 0.3s; display: flex; align-items: center; gap: 8px; }
        .nav-btn:hover { border-color: #4299e1; background: #ebf8ff; }
        .nav-btn.active { background: #4299e1; color: white; border-color: #4299e1; }
        .nav-btn .icon { font-size: 1.1em; }

        .main-section { display: none; }
        .main-section.active { display: block; }

        /* Stats Grid */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .stat-card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); text-align: center; }
        .stat-number { font-size: 2.2em; font-weight: 700; color: #4299e1; }
        .stat-label { color: #718096; font-size: 0.85em; }

        /* Tables */
        .table-container { overflow-x: auto; margin-bottom: 30px; }
        table { width: 100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.08); min-width: 1200px; }
        th { background: #2d3748; color: white; padding: 10px 8px; text-align: left; font-weight: 600; font-size: 0.75em; cursor: pointer; white-space: nowrap; }
        th:hover { background: #4a5568; }
        th.sortable::after { content: ' ↕'; opacity: 0.5; }
        th.sort-asc::after { content: ' ↑'; opacity: 1; }
        th.sort-desc::after { content: ' ↓'; opacity: 1; }
        td { padding: 8px; border-bottom: 1px solid #e2e8f0; font-size: 0.8em; vertical-align: top; }
        td.wrap { white-space: normal; max-width: 120px; }
        tr:hover { background: #f7fafc; }
        tr:last-child td { border-bottom: none; }
        a { color: #4299e1; text-decoration: none; }
        a:hover { text-decoration: underline; }

        /* Status & Potential Badges */
        .status, .potential, .coverage { padding: 2px 6px; border-radius: 10px; font-size: 0.7em; font-weight: 600; display: inline-block; }
        .status-active { background: #c6f6d5; color: #276749; }
        .status-pending { background: #fef3c7; color: #92400e; }
        .status-planned { background: #e9d8fd; color: #553c9a; }
        .status-voluntary { background: #e2e8f0; color: #4a5568; }
        .status-phased { background: #feebc8; color: #c05621; }
        .potential-very-high { background: #fed7d7; color: #c53030; }
        .potential-high { background: #feebc8; color: #c05621; }
        .potential-medium { background: #bee3f8; color: #2b6cb0; }
        .potential-low { background: #e2e8f0; color: #4a5568; }
        .potential-mature { background: #e9d8fd; color: #553c9a; }
        .coverage-b2b { background: #c6f6d5; color: #276749; }
        .coverage-b2g { background: #bee3f8; color: #2b6cb0; }
        .coverage-b2c { background: #feebc8; color: #c05621; }
        .accred-yes { color: #c53030; font-weight: 600; }
        .accred-no { color: #276749; }

        /* Sort Controls */
        .sort-controls { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 15px; align-items: center; }
        .sort-btn { padding: 6px 12px; border: 1px solid #e2e8f0; border-radius: 15px; background: white; cursor: pointer; font-size: 0.8em; transition: all 0.2s; }
        .sort-btn:hover { border-color: #4299e1; background: #ebf8ff; }
        .sort-btn.active { background: #4299e1; color: white; border-color: #4299e1; }

        /* Search */
        .search-box { width: 100%; max-width: 400px; padding: 10px 14px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 0.95em; margin-bottom: 15px; }
        .search-box:focus { outline: none; border-color: #4299e1; }

        /* Timeline Graph */
        .timeline-graph { background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 30px; overflow-x: auto; }
        .timeline-visual { position: relative; height: 400px; min-width: 800px; }
        .timeline-axis { position: absolute; bottom: 30px; left: 60px; right: 20px; height: 2px; background: #2d3748; }
        .timeline-year-mark { position: absolute; bottom: 20px; transform: translateX(-50%); font-size: 0.8em; font-weight: 600; color: #2d3748; }
        .timeline-year-mark::before { content: ''; position: absolute; top: -8px; left: 50%; width: 2px; height: 10px; background: #2d3748; }
        .timeline-item-dot { position: absolute; width: 12px; height: 12px; border-radius: 50%; transform: translate(-50%, 50%); cursor: pointer; transition: all 0.2s; }
        .timeline-item-dot:hover { transform: translate(-50%, 50%) scale(1.3); }
        .timeline-item-label { position: absolute; font-size: 0.7em; white-space: nowrap; transform: translateX(-50%) rotate(-45deg); transform-origin: top center; }
        .dot-active { background: #48bb78; }
        .dot-pending { background: #ecc94b; }
        .dot-planned { background: #9f7aea; }

        /* Legend Box */
        .legend-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; margin-top: 40px; margin-bottom: 25px; }
        .legend-box { background: white; border-radius: 10px; padding: 15px 18px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
        .legend-box h4 { color: #2d3748; font-size: 0.9em; margin-bottom: 10px; border-bottom: 1px solid #e2e8f0; padding-bottom: 8px; }
        .legend-item { display: flex; align-items: flex-start; margin-bottom: 5px; font-size: 0.78em; }
        .legend-item:last-child { margin-bottom: 0; }
        .legend-item .badge { min-width: 70px; margin-right: 8px; }
        .legend-item .desc { color: #4a5568; }

        /* Footer */
        .footer { margin-top: 40px; padding: 20px; text-align: center; color: #718096; font-size: 0.85em; }

        /* Ticker */
        .ticker-wrap { width: 100%; overflow: hidden; background: linear-gradient(90deg, #2d3748, #4a5568); padding: 8px 0; margin-bottom: 20px; border-radius: 8px; }
        .ticker { display: inline-block; white-space: nowrap; animation: ticker 25s linear infinite; }
        .ticker-item { display: inline-block; padding: 0 50px; color: #fbd38d; font-weight: 600; font-size: 0.85em; }
        .ticker-item span { color: #fff; }
        @keyframes ticker { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        /* Players */
        .players { font-size: 0.75em; color: #4a5568; }
        .players strong { color: #2b6cb0; }
        .small-text { font-size: 0.7em; color: #718096; }

        /* Tabs */
        .tabs { display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 20px; }
        .tab { padding: 8px 16px; background: #e2e8f0; border: none; border-radius: 20px; cursor: pointer; font-size: 0.9em; transition: all 0.2s; }
        .tab:hover { background: #cbd5e0; }
        .tab.active { background: #4299e1; color: white; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        @media (max-width: 768px) {
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            table { font-size: 0.75em; }
            th, td { padding: 6px 4px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Running Ticker Disclaimer -->
        <div class="ticker-wrap">
            <div class="ticker">
                <div class="ticker-item">&#9888;&#65039; <span>DISCLAIMER:</span> This knowledge base is created as of 6 Jan 2025. Data may have changed since then.</div>
                <div class="ticker-item">&#128202; <span>Sources:</span> IMF, VATupdate, KPMG, Basware, Storecove, EDICOM, Fonoa, World Bank</div>
                <div class="ticker-item">&#9888;&#65039; <span>DISCLAIMER:</span> This knowledge base is created as of 6 Jan 2025. Data may have changed since then.</div>
            </div>
        </div>

        <h1>Global E-Invoicing Country Analysis</h1>
        <p class="subtitle">Comprehensive market intelligence for e-invoicing compliance and expansion</p>

        <!-- Main Navigation -->
        <div class="main-nav">
            <button class="nav-btn active" onclick="showMainSection('overview')"><span class="icon">&#128202;</span> Master Table</button>
            <button class="nav-btn" onclick="showMainSection('timeline')"><span class="icon">&#128197;</span> Timeline</button>
            <button class="nav-btn" onclick="showMainSection('regions')"><span class="icon">&#127757;</span> By Region</button>
            <button class="nav-btn" onclick="showMainSection('legend')"><span class="icon">&#128218;</span> Legend & Methodology</button>
        </div>

        <!-- Section: Overview -->
        <div id="overview" class="main-section active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">30+</div>
                    <div class="stat-label">Countries Tracked</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">$85T+</div>
                    <div class="stat-label">Total GDP Covered</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">~500M</div>
                    <div class="stat-label">Est. Enterprises</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">~50B+</div>
                    <div class="stat-label">Est. Annual Invoices</div>
                </div>
            </div>

            <input type="text" class="search-box" id="searchBox" placeholder="Search countries..." onkeyup="filterTable()">

            <div class="sort-controls">
                <span style="font-size:0.85em; color:#4a5568;">Sort by:</span>
                <button class="sort-btn" onclick="sortTable('country')">Country</button>
                <button class="sort-btn" onclick="sortTable('gdp')">GDP</button>
                <button class="sort-btn" onclick="sortTable('potential')">Potential</button>
                <button class="sort-btn" onclick="sortTable('tam')">TAM</button>
                <button class="sort-btn" onclick="sortTable('enterprises')">Enterprises</button>
                <button class="sort-btn" onclick="sortTable('accredTime')">Accred. Time</button>
            </div>

            <h2>Master Table</h2>
            <div class="table-container">
            <table id="masterTable">
                <thead>
                    <tr>
                        <th>#</th>
                        <th class="sortable">Country</th>
                        <th class="sortable">GDP</th>
                        <th class="sortable">Potential</th>
                        <th class="wrap">Mandate</th>
                        <th>Coverage</th>
                        <th>Model</th>
                        <th>Status</th>
                        <th class="sortable">Enterprises</th>
                        <th class="sortable">Est. Invoices/Yr</th>
                        <th class="sortable">TAM ($M)</th>
                        <th>Tax Authority</th>
                        <th>Accred?</th>
                        <th class="sortable">Accred Time</th>
                        <th>Providers</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                </tbody>
            </table>
            </div>
        </div>

        <!-- Section: Timeline -->
        <div id="timeline" class="main-section">
            <h2>E-Invoicing Mandate Timeline (2025-2030)</h2>
            <div class="timeline-graph">
                <div class="timeline-visual" id="timelineVisual">
                    <!-- Timeline will be generated by JS -->
                </div>
            </div>
            <h3>Detailed Timeline</h3>
            <div class="table-container">
            <table>
                <thead><tr><th>Date</th><th>Country</th><th>Event</th><th>Coverage</th><th>Notes</th></tr></thead>
                <tbody>
                    <tr><td>Jan 2025</td><td>Germany</td><td>RECEIVE mandate</td><td><span class="coverage coverage-b2b">B2B</span></td><td>Must accept e-invoices in EN 16931 format</td></tr>
                    <tr><td>Jan 2025</td><td>Israel</td><td>Clearance begins</td><td><span class="coverage coverage-b2b">B2B</span> <span class="coverage coverage-b2g">B2G</span></td><td>SHAAM system rollout</td></tr>
                    <tr><td>Apr 2025</td><td>Jordan</td><td>Full mandate</td><td><span class="coverage coverage-b2b">B2B</span> <span class="coverage coverage-b2g">B2G</span></td><td>JoFotara system</td></tr>
                    <tr><td>Jul 2025</td><td>Malaysia</td><td>Phase 1</td><td><span class="coverage coverage-b2b">B2B</span> <span class="coverage coverage-b2g">B2G</span></td><td>Large taxpayers (>RM100M)</td></tr>
                    <tr><td>Nov 2025</td><td>Singapore</td><td>InvoiceNow Phase 1</td><td><span class="coverage coverage-b2g">B2G</span></td><td>Government suppliers first</td></tr>
                    <tr><td>Late 2025</td><td>China</td><td>Nationwide expansion</td><td><span class="coverage coverage-b2b">B2B</span> <span class="coverage coverage-b2g">B2G</span> <span class="coverage coverage-b2c">B2C</span></td><td>Fully Digital Fapiao</td></tr>
                    <tr><td>Jan 2026</td><td>Belgium</td><td>Full B2B mandate</td><td><span class="coverage coverage-b2b">B2B</span></td><td>Peppol required</td></tr>
                    <tr><td>Feb 2026</td><td>Poland</td><td>KSeF Phase 1</td><td><span class="coverage coverage-b2b">B2B</span></td><td>Large taxpayers first</td></tr>
                    <tr><td>Jul 2026</td><td>UAE</td><td>Pilot</td><td><span class="coverage coverage-b2b">B2B</span> <span class="coverage coverage-b2g">B2G</span></td><td>Clearance model expected</td></tr>
                    <tr><td>Aug 2026</td><td>Oman</td><td>Top 100 pilot</td><td><span class="coverage coverage-b2b">B2B</span> <span class="coverage coverage-b2g">B2G</span></td><td>Peppol 5-corner; Full Feb 2027</td></tr>
                    <tr><td>Sep 2026</td><td>France</td><td>Large/Mid companies</td><td><span class="coverage coverage-b2b">B2B</span></td><td>PPF + PDP model</td></tr>
                    <tr><td>Jan 2027</td><td>Germany</td><td>SEND mandate (large)</td><td><span class="coverage coverage-b2b">B2B</span></td><td>>&#8364;800k turnover; All Jan 2028</td></tr>
                    <tr><td>2027</td><td>Spain</td><td>Large businesses</td><td><span class="coverage coverage-b2b">B2B</span></td><td>Verifactu system</td></tr>
                    <tr><td>Sep 2027</td><td>France</td><td>SMEs</td><td><span class="coverage coverage-b2b">B2B</span></td><td>All businesses covered</td></tr>
                    <tr><td>Jul 2030</td><td>EU (ViDA)</td><td>Intra-EU B2B</td><td><span class="coverage coverage-b2b">B2B</span></td><td>All EU member states</td></tr>
                </tbody>
            </table>
            </div>
        </div>

        <!-- Section: By Region -->
        <div id="regions" class="main-section">
            <h2>Regional Breakdown</h2>
            <div class="tabs">
                <button class="tab active" onclick="showRegion('europe')">Europe</button>
                <button class="tab" onclick="showRegion('asia')">Asia-Pacific</button>
                <button class="tab" onclick="showRegion('middle-east')">Middle East</button>
                <button class="tab" onclick="showRegion('latam')">Latin America</button>
            </div>

            <div id="europe" class="tab-content active">
                <div class="table-container">
                <table>
                    <thead><tr><th>Country</th><th>GDP</th><th>Mandate</th><th>Coverage</th><th>Model</th><th>Tax Authority</th></tr></thead>
                    <tbody>
                        <tr><td>Germany</td><td>$4,520B</td><td>2025-2028</td><td>B2B</td><td>EN 16931</td><td><a href="https://www.bzst.de" target="_blank">BZSt</a></td></tr>
                        <tr><td>France</td><td>$3,030B</td><td>Sep 2026</td><td>B2B</td><td>PPF+PDP</td><td><a href="https://www.impots.gouv.fr" target="_blank">DGFiP</a></td></tr>
                        <tr><td>Italy</td><td>$2,250B</td><td>2019</td><td>B2B, B2G, B2C</td><td>SdI</td><td><a href="https://www.agenziaentrate.gov.it" target="_blank">AdE</a></td></tr>
                        <tr><td>Spain</td><td>$1,580B</td><td>2027</td><td>B2B</td><td>Verifactu</td><td><a href="https://www.agenciatributaria.es" target="_blank">AEAT</a></td></tr>
                        <tr><td>Poland</td><td>$750B</td><td>Feb 2026</td><td>B2B</td><td>KSeF</td><td><a href="https://www.podatki.gov.pl" target="_blank">KAS</a></td></tr>
                        <tr><td>Belgium</td><td>$630B</td><td>Jan 2026</td><td>B2B</td><td>Peppol</td><td><a href="https://finances.belgium.be" target="_blank">SPF Finances</a></td></tr>
                    </tbody>
                </table>
                </div>
            </div>
            <div id="asia" class="tab-content">
                <div class="table-container">
                <table>
                    <thead><tr><th>Country</th><th>GDP</th><th>Mandate</th><th>Coverage</th><th>Model</th><th>Tax Authority</th></tr></thead>
                    <tbody>
                        <tr><td>China</td><td>$17,960B</td><td>Late 2025</td><td>B2B, B2G, B2C</td><td>Golden Tax</td><td><a href="http://www.chinatax.gov.cn" target="_blank">STA</a></td></tr>
                        <tr><td>India</td><td>$3,730B</td><td>2020</td><td>B2B, B2G</td><td>GST IRP</td><td><a href="https://www.gst.gov.in" target="_blank">GSTN</a></td></tr>
                        <tr><td>Japan</td><td>$4,230B</td><td>QIS 2023</td><td>B2B</td><td>Peppol</td><td><a href="https://www.nta.go.jp" target="_blank">NTA</a></td></tr>
                        <tr><td>Indonesia</td><td>$1,390B</td><td>2025-2026</td><td>B2B, B2G</td><td>Coretax</td><td><a href="https://www.pajak.go.id" target="_blank">DJP</a></td></tr>
                        <tr><td>Malaysia</td><td>$430B</td><td>Jul 2025</td><td>B2B, B2G</td><td>MyInvois</td><td><a href="https://www.hasil.gov.my" target="_blank">LHDN</a></td></tr>
                        <tr><td>Singapore</td><td>$500B</td><td>Nov 2025</td><td>B2G</td><td>Peppol</td><td><a href="https://www.iras.gov.sg" target="_blank">IRAS</a></td></tr>
                    </tbody>
                </table>
                </div>
            </div>
            <div id="middle-east" class="tab-content">
                <div class="table-container">
                <table>
                    <thead><tr><th>Country</th><th>GDP</th><th>Mandate</th><th>Coverage</th><th>Model</th><th>Tax Authority</th></tr></thead>
                    <tbody>
                        <tr><td>Saudi Arabia</td><td>$1,070B</td><td>2021-2026</td><td>B2B, B2G, B2C</td><td>FATOORA</td><td><a href="https://zatca.gov.sa" target="_blank">ZATCA</a></td></tr>
                        <tr><td>UAE</td><td>$500B</td><td>Jul 2026</td><td>B2B, B2G</td><td>Clearance</td><td><a href="https://tax.gov.ae" target="_blank">FTA</a></td></tr>
                        <tr><td>Turkey</td><td>$1,110B</td><td>2014</td><td>B2B, B2G</td><td>GIB</td><td><a href="https://www.gib.gov.tr" target="_blank">GIB</a></td></tr>
                        <tr><td>Egypt</td><td>$400B</td><td>2020-2025</td><td>B2B, B2G</td><td>ETA</td><td><a href="https://www.eta.gov.eg" target="_blank">ETA</a></td></tr>
                        <tr><td>Oman</td><td>$115B</td><td>Aug 2026</td><td>B2B, B2G</td><td>Peppol</td><td><a href="https://tms.taxoman.gov.om" target="_blank">Tax Authority</a></td></tr>
                    </tbody>
                </table>
                </div>
            </div>
            <div id="latam" class="tab-content">
                <div class="table-container">
                <table>
                    <thead><tr><th>Country</th><th>GDP</th><th>Mandate</th><th>Coverage</th><th>Model</th><th>Tax Authority</th></tr></thead>
                    <tbody>
                        <tr><td>Brazil</td><td>$2,170B</td><td>2008</td><td>B2B, B2G, B2C</td><td>NF-e</td><td><a href="https://www.gov.br/receitafederal" target="_blank">RFB</a></td></tr>
                        <tr><td>Mexico</td><td>$1,470B</td><td>2010</td><td>B2B, B2G, B2C</td><td>CFDI</td><td><a href="https://www.sat.gob.mx" target="_blank">SAT</a></td></tr>
                        <tr><td>Chile</td><td>$340B</td><td>2014</td><td>B2B, B2G</td><td>Clearance</td><td><a href="https://www.sii.cl" target="_blank">SII</a></td></tr>
                        <tr><td>Colombia</td><td>$340B</td><td>2018</td><td>B2B, B2G</td><td>Clearance</td><td><a href="https://www.dian.gov.co" target="_blank">DIAN</a></td></tr>
                    </tbody>
                </table>
                </div>
            </div>
        </div>

        <!-- Section: Legend & Methodology -->
        <div id="legend" class="main-section">
            <h2>Legend & Methodology</h2>
            <div class="legend-container">
                <div class="legend-box">
                    <h4>&#128202; Potential Rating Formula</h4>
                    <div class="legend-item"><span class="desc"><strong>Potential Score</strong> = (GDP Weight x 40%) + (Mandate Stage x 30%) + (Market Maturity x 30%)</span></div>
                    <div class="legend-item"><span class="badge"><span class="potential potential-very-high">Very High</span></span><span class="desc">Score > 80: GDP >$1T + New mandate (high growth)</span></div>
                    <div class="legend-item"><span class="badge"><span class="potential potential-high">High</span></span><span class="desc">Score 60-80: GDP $300B-$1T OR strong mandate momentum</span></div>
                    <div class="legend-item"><span class="badge"><span class="potential potential-medium">Medium</span></span><span class="desc">Score 40-60: GDP $100B-$300B OR niche opportunity</span></div>
                    <div class="legend-item"><span class="badge"><span class="potential potential-mature">Mature</span></span><span class="desc">Mandate 5+ years; Compliance saturated, value-add opportunity</span></div>
                    <div class="legend-item"><span class="badge"><span class="potential potential-low">Low</span></span><span class="desc">Score < 40: GDP <$100B with limited adoption</span></div>
                </div>
                <div class="legend-box">
                    <h4>&#127970; Model Types</h4>
                    <div class="legend-item"><strong style="min-width:70px;">Clearance</strong><span class="desc">Invoice approved by tax authority BEFORE sent to buyer</span></div>
                    <div class="legend-item"><strong style="min-width:70px;">RTIR</strong><span class="desc">Real-Time Invoice Reporting to authority</span></div>
                    <div class="legend-item"><strong style="min-width:70px;">CTC</strong><span class="desc">Continuous Transaction Controls - ongoing reporting</span></div>
                    <div class="legend-item"><strong style="min-width:70px;">Peppol</strong><span class="desc">Open network for B2B/B2G exchange (4-corner)</span></div>
                    <div class="legend-item"><strong style="min-width:70px;">Hybrid</strong><span class="desc">Mix of models (e.g., PPF+PDP in France)</span></div>
                    <div class="legend-item"><strong style="min-width:70px;">ViDA</strong><span class="desc">EU VAT in Digital Age - Jul 2030 mandate</span></div>
                </div>
                <div class="legend-box">
                    <h4>&#128176; TAM Calculation</h4>
                    <div class="legend-item"><span class="desc"><strong>TAM</strong> = Enterprises x Est. Invoices/Enterprise x $0.10-0.50/invoice</span></div>
                    <div class="legend-item"><span class="desc">Invoice estimates based on: GDP/enterprise avg, sector mix, B2B transaction volumes from World Bank and local statistics.</span></div>
                    <div class="legend-item"><span class="desc">Pricing assumes blended rate across compliance, transmission, archival.</span></div>
                </div>
                <div class="legend-box">
                    <h4>&#128205; Coverage Types</h4>
                    <div class="legend-item"><span class="badge"><span class="coverage coverage-b2b">B2B</span></span><span class="desc">Business-to-Business transactions</span></div>
                    <div class="legend-item"><span class="badge"><span class="coverage coverage-b2g">B2G</span></span><span class="desc">Business-to-Government transactions</span></div>
                    <div class="legend-item"><span class="badge"><span class="coverage coverage-b2c">B2C</span></span><span class="desc">Business-to-Consumer transactions</span></div>
                </div>
                <div class="legend-box">
                    <h4>&#128221; Accreditation Notes</h4>
                    <div class="legend-item"><span class="desc"><strong>Accreditation Required:</strong> Whether formal certification/registration with tax authority is needed to operate as an e-invoice provider.</span></div>
                    <div class="legend-item"><span class="desc"><strong>Timeline:</strong> Typical time from application to approval. Assumes Clear is already a Peppol-certified AP, which expedites some processes.</span></div>
                    <div class="legend-item"><span class="desc">Timelines are estimates; actual may vary based on completeness of application and authority workload.</span></div>
                </div>
                <div class="legend-box">
                    <h4>&#128200; Market Share %</h4>
                    <div class="legend-item"><span class="desc">Percentages = <strong>estimated share of e-invoice transactions</strong> by provider. Based on industry research, analyst reports, public filings. "(Gov)" = government platform.</span></div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p><strong>Sources:</strong> IMF, VATupdate, KPMG, Basware, Storecove, EDICOM, Fonoa, World Bank, Tax Authority websites</p>
            <p><strong>Knowledge Base Created:</strong> 6 January 2025</p>
        </div>
    </div>

    <script>
        // Country data with all fields
        const countries = [
            { id: 1, country: 'Brazil', flag: '&#127463;&#127479;', gdp: 2170, gdpStr: '$2,170B', potential: 'Mature', potentialScore: 3, mandate: '2008', coverage: ['B2B','B2G','B2C'], model: 'NF-e (Clearance)', status: 'Active', enterprises: 22000000, invoices: 4500000000, tam: 900, taxAuth: 'RFB', taxUrl: 'https://www.gov.br/receitafederal', accred: 'Yes', accredTime: '6-12 mo', accredMonths: 9, providers: 'Sovos 25%, EDICOM 18%' },
            { id: 2, country: 'Mexico', flag: '&#127474;&#127485;', gdp: 1470, gdpStr: '$1,470B', potential: 'Mature', potentialScore: 3, mandate: '2010', coverage: ['B2B','B2G','B2C'], model: 'CFDI (Clearance)', status: 'Active', enterprises: 5500000, invoices: 2800000000, tam: 560, taxAuth: 'SAT', taxUrl: 'https://www.sat.gob.mx', accred: 'Yes (PAC)', accredTime: '3-6 mo', accredMonths: 4, providers: 'Edicom 20%, Sovos 15%' },
            { id: 3, country: 'South Korea', flag: '&#127472;&#127479;', gdp: 1710, gdpStr: '$1,710B', potential: 'Mature', potentialScore: 3, mandate: '2011', coverage: ['B2B','B2G'], model: 'RTIR', status: 'Active', enterprises: 7200000, invoices: 1200000000, tam: 240, taxAuth: 'NTS', taxUrl: 'https://www.nts.go.kr', accred: 'No', accredTime: 'N/A', accredMonths: 0, providers: 'NTS (Gov) 80%' },
            { id: 4, country: 'Turkey', flag: '&#127481;&#127479;', gdp: 1110, gdpStr: '$1,110B', potential: 'Mature', potentialScore: 3, mandate: '2014', coverage: ['B2B','B2G'], model: 'GIB (Clearance)', status: 'Active', enterprises: 3800000, invoices: 900000000, tam: 180, taxAuth: 'GIB', taxUrl: 'https://www.gib.gov.tr', accred: 'Yes', accredTime: '3-6 mo', accredMonths: 4, providers: 'Foriba 30%, Logo 20%' },
            { id: 5, country: 'Italy', flag: '&#127470;&#127481;', gdp: 2250, gdpStr: '$2,250B', potential: 'High', potentialScore: 4, mandate: '2019', coverage: ['B2B','B2G','B2C'], model: 'SdI (Clearance)', status: 'Active', enterprises: 4500000, invoices: 2400000000, tam: 480, taxAuth: 'AdE', taxUrl: 'https://www.agenziaentrate.gov.it', accred: 'No', accredTime: 'N/A', accredMonths: 0, providers: 'Aruba 25%, TeamSystem 20%' },
            { id: 6, country: 'India', flag: '&#127470;&#127475;', gdp: 3730, gdpStr: '$3,730B', potential: 'Very High', potentialScore: 5, mandate: '2020', coverage: ['B2B','B2G'], model: 'GST IRP (Clearance)', status: 'Active', enterprises: 63000000, invoices: 8000000000, tam: 1600, taxAuth: 'GSTN', taxUrl: 'https://www.gst.gov.in', accred: 'Yes (IRP/GSP)', accredTime: '2-4 mo', accredMonths: 3, providers: 'ClearTax 35%, Vayana 20%' },
            { id: 7, country: 'Saudi Arabia', flag: '&#127480;&#127462;', gdp: 1070, gdpStr: '$1,070B', potential: 'Very High', potentialScore: 5, mandate: '2021-2026', coverage: ['B2B','B2G','B2C'], model: 'FATOORA (Clearance)', status: 'Active', enterprises: 1100000, invoices: 450000000, tam: 135, taxAuth: 'ZATCA', taxUrl: 'https://zatca.gov.sa', accred: 'Yes', accredTime: '3-6 mo', accredMonths: 4, providers: 'Sovos 22%, EDICOM 18%' },
            { id: 8, country: 'Germany', flag: '&#127465;&#127466;', gdp: 4520, gdpStr: '$4,520B', potential: 'Very High', potentialScore: 5, mandate: '2025-2028', coverage: ['B2B'], model: 'EN 16931 (Flexible)', status: 'Phased', enterprises: 3700000, invoices: 3200000000, tam: 960, taxAuth: 'BZSt', taxUrl: 'https://www.bzst.de', accred: 'No', accredTime: 'N/A', accredMonths: 0, providers: 'SAP 30%, Pagero 15%' },
            { id: 9, country: 'France', flag: '&#127467;&#127479;', gdp: 3030, gdpStr: '$3,030B', potential: 'Very High', potentialScore: 5, mandate: 'Sep 2026', coverage: ['B2B'], model: 'PPF+PDP (Hybrid)', status: 'Pending', enterprises: 4200000, invoices: 2800000000, tam: 840, taxAuth: 'DGFiP', taxUrl: 'https://www.impots.gouv.fr', accred: 'Yes (PDP)', accredTime: '6-9 mo', accredMonths: 7, providers: 'Chorus Pro (Gov), Generix 15%' },
            { id: 10, country: 'Spain', flag: '&#127466;&#127480;', gdp: 1580, gdpStr: '$1,580B', potential: 'Very High', potentialScore: 5, mandate: '2027', coverage: ['B2B'], model: 'Verifactu', status: 'Pending', enterprises: 3400000, invoices: 1800000000, tam: 540, taxAuth: 'AEAT', taxUrl: 'https://www.agenciatributaria.es', accred: 'Yes', accredTime: '3-6 mo', accredMonths: 4, providers: 'EDICOM 25%, Seres 18%' },
            { id: 11, country: 'China', flag: '&#127464;&#127475;', gdp: 17960, gdpStr: '$17,960B', potential: 'Very High', potentialScore: 5, mandate: 'Late 2025', coverage: ['B2B','B2G','B2C'], model: 'Golden Tax (Clearance)', status: 'Active', enterprises: 44000000, invoices: 15000000000, tam: 3000, taxAuth: 'STA', taxUrl: 'http://www.chinatax.gov.cn', accred: 'Yes', accredTime: '12+ mo', accredMonths: 15, providers: 'Baiwang 35%, Aisino 30%' },
            { id: 12, country: 'Japan', flag: '&#127471;&#127477;', gdp: 4230, gdpStr: '$4,230B', potential: 'Very High', potentialScore: 5, mandate: 'QIS 2023', coverage: ['B2B'], model: 'Peppol', status: 'Voluntary (QIS)', enterprises: 3600000, invoices: 2200000000, tam: 660, taxAuth: 'NTA', taxUrl: 'https://www.nta.go.jp', accred: 'No', accredTime: 'N/A', accredMonths: 0, providers: 'TKC 15%, Freee 12%' },
            { id: 13, country: 'Indonesia', flag: '&#127470;&#127465;', gdp: 1390, gdpStr: '$1,390B', potential: 'Very High', potentialScore: 5, mandate: '2025-2026', coverage: ['B2B','B2G'], model: 'Coretax (Clearance)', status: 'Active', enterprises: 65000000, invoices: 2500000000, tam: 500, taxAuth: 'DJP', taxUrl: 'https://www.pajak.go.id', accred: 'Yes', accredTime: '6-9 mo', accredMonths: 7, providers: 'DJP (Gov), OnlinePajak 20%' },
            { id: 14, country: 'Malaysia', flag: '&#127474;&#127486;', gdp: 430, gdpStr: '$430B', potential: 'High', potentialScore: 4, mandate: 'Jul 2025', coverage: ['B2B','B2G'], model: 'MyInvois', status: 'Active', enterprises: 1200000, invoices: 350000000, tam: 105, taxAuth: 'LHDN', taxUrl: 'https://www.hasil.gov.my', accred: 'No', accredTime: 'N/A', accredMonths: 0, providers: 'LHDN (Gov), Storecove 12%' },
            { id: 15, country: 'Singapore', flag: '&#127480;&#127468;', gdp: 500, gdpStr: '$500B', potential: 'High', potentialScore: 4, mandate: 'Nov 2025', coverage: ['B2G'], model: 'Peppol', status: 'Active', enterprises: 280000, invoices: 180000000, tam: 54, taxAuth: 'IRAS', taxUrl: 'https://www.iras.gov.sg', accred: 'Yes (Peppol AP)', accredTime: '1-2 mo', accredMonths: 1, providers: 'InvoiceNow (Gov), Storecove 15%' },
            { id: 16, country: 'Belgium', flag: '&#127463;&#127466;', gdp: 630, gdpStr: '$630B', potential: 'High', potentialScore: 4, mandate: 'Jan 2026', coverage: ['B2B'], model: 'Peppol', status: 'Pending', enterprises: 1100000, invoices: 420000000, tam: 126, taxAuth: 'SPF Finances', taxUrl: 'https://finances.belgium.be', accred: 'Yes (Peppol AP)', accredTime: '1-2 mo', accredMonths: 1, providers: 'Basware 15%, Pagero 12%' },
            { id: 17, country: 'Poland', flag: '&#127477;&#127473;', gdp: 750, gdpStr: '$750B', potential: 'High', potentialScore: 4, mandate: 'Feb 2026', coverage: ['B2B'], model: 'KSeF (Clearance)', status: 'Pending', enterprises: 2300000, invoices: 850000000, tam: 255, taxAuth: 'KAS', taxUrl: 'https://www.podatki.gov.pl', accred: 'No', accredTime: 'N/A', accredMonths: 0, providers: 'KSeF (Gov), Comarch 25%' },
            { id: 18, country: 'UAE', flag: '&#127462;&#127466;', gdp: 500, gdpStr: '$500B', potential: 'High', potentialScore: 4, mandate: 'Jul 2026', coverage: ['B2B','B2G'], model: 'Clearance', status: 'Pending', enterprises: 450000, invoices: 280000000, tam: 84, taxAuth: 'FTA', taxUrl: 'https://tax.gov.ae', accred: 'TBD', accredTime: 'TBD', accredMonths: 6, providers: 'Sovos 20%, EDICOM 15%' },
            { id: 19, country: 'Australia', flag: '&#127462;&#127482;', gdp: 1720, gdpStr: '$1,720B', potential: 'High', potentialScore: 4, mandate: 'Voluntary', coverage: ['B2G'], model: 'Peppol', status: 'Voluntary', enterprises: 2500000, invoices: 1100000000, tam: 330, taxAuth: 'ATO', taxUrl: 'https://www.ato.gov.au', accred: 'Yes (Peppol AP)', accredTime: '1-2 mo', accredMonths: 1, providers: 'Link4 18%, MessageXchange 15%' },
            { id: 20, country: 'USA', flag: '&#127482;&#127480;', gdp: 27360, gdpStr: '$27,360B', potential: 'Very High', potentialScore: 5, mandate: 'Voluntary', coverage: ['B2B'], model: 'DBNAlliance', status: 'Voluntary', enterprises: 33000000, invoices: 25000000000, tam: 5000, taxAuth: 'IRS', taxUrl: 'https://www.irs.gov', accred: 'No', accredTime: 'N/A', accredMonths: 0, providers: 'Coupa, SAP Ariba, Tradeshift' },
            { id: 21, country: 'UK', flag: '&#127468;&#127463;', gdp: 3340, gdpStr: '$3,340B', potential: 'High', potentialScore: 4, mandate: 'B2G Active', coverage: ['B2G'], model: 'Peppol', status: 'Voluntary', enterprises: 5900000, invoices: 2800000000, tam: 840, taxAuth: 'HMRC', taxUrl: 'https://www.gov.uk/government/organisations/hm-revenue-customs', accred: 'Yes (Peppol AP)', accredTime: '1-2 mo', accredMonths: 1, providers: 'Pagero, Tungsten, Basware' },
            { id: 22, country: 'Oman', flag: '&#127476;&#127474;', gdp: 115, gdpStr: '$115B', potential: 'Medium', potentialScore: 2, mandate: 'Aug 2026', coverage: ['B2B','B2G'], model: 'Peppol 5-corner', status: 'Pending', enterprises: 85000, invoices: 45000000, tam: 14, taxAuth: 'Tax Authority', taxUrl: 'https://tms.taxoman.gov.om', accred: 'Yes (Peppol AP)', accredTime: '1-2 mo', accredMonths: 1, providers: 'Peppol APs, Storecove 10%' },
            { id: 23, country: 'Vietnam', flag: '&#127483;&#127475;', gdp: 450, gdpStr: '$450B', potential: 'High', potentialScore: 4, mandate: '2022', coverage: ['B2B','B2G'], model: 'Clearance', status: 'Active', enterprises: 800000, invoices: 320000000, tam: 96, taxAuth: 'GDT', taxUrl: 'https://www.gdt.gov.vn', accred: 'Yes', accredTime: '3-6 mo', accredMonths: 4, providers: 'MISA 30%, Viettel 25%' },
            { id: 24, country: 'Romania', flag: '&#127479;&#127476;', gdp: 350, gdpStr: '$350B', potential: 'High', potentialScore: 4, mandate: 'Jan 2024', coverage: ['B2B','B2G'], model: 'RTIR', status: 'Active', enterprises: 900000, invoices: 280000000, tam: 84, taxAuth: 'ANAF', taxUrl: 'https://www.anaf.ro', accred: 'No', accredTime: 'N/A', accredMonths: 0, providers: 'ANAF (Gov), Postis 18%' },
            { id: 25, country: 'Hungary', flag: '&#127469;&#127482;', gdp: 210, gdpStr: '$210B', potential: 'Mature', potentialScore: 3, mandate: '2018', coverage: ['B2B','B2G'], model: 'RTIR (NAV)', status: 'Active', enterprises: 750000, invoices: 180000000, tam: 54, taxAuth: 'NAV', taxUrl: 'https://nav.gov.hu', accred: 'No', accredTime: 'N/A', accredMonths: 0, providers: 'NAV (Gov), Ecosio 15%' },
            { id: 26, country: 'Chile', flag: '&#127464;&#127473;', gdp: 340, gdpStr: '$340B', potential: 'Mature', potentialScore: 3, mandate: '2014', coverage: ['B2B','B2G'], model: 'Clearance', status: 'Active', enterprises: 1200000, invoices: 250000000, tam: 75, taxAuth: 'SII', taxUrl: 'https://www.sii.cl', accred: 'No', accredTime: 'N/A', accredMonths: 0, providers: 'SII (Gov), Sovos 20%' },
        ];

        let currentSort = { field: null, desc: true };

        function renderTable(data) {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = data.map((c, i) => `
                <tr>
                    <td>${i + 1}</td>
                    <td><strong>${c.flag} ${c.country}</strong></td>
                    <td>${c.gdpStr}</td>
                    <td><span class="potential potential-${c.potential.toLowerCase().replace(' ','-')}">${c.potential}</span></td>
                    <td class="wrap">${c.mandate}</td>
                    <td>${c.coverage.map(cov => `<span class="coverage coverage-${cov.toLowerCase()}">${cov}</span>`).join(' ')}</td>
                    <td class="small-text">${c.model}</td>
                    <td><span class="status status-${c.status.toLowerCase().split(' ')[0]}">${c.status}</span></td>
                    <td>${(c.enterprises/1000000).toFixed(1)}M</td>
                    <td>${(c.invoices/1000000000).toFixed(1)}B</td>
                    <td>$${c.tam}</td>
                    <td><a href="${c.taxUrl}" target="_blank">${c.taxAuth}</a></td>
                    <td class="${c.accred.includes('Yes') ? 'accred-yes' : 'accred-no'}">${c.accred}</td>
                    <td>${c.accredTime}</td>
                    <td class="players small-text">${c.providers}</td>
                </tr>
            `).join('');
        }

        function sortTable(field) {
            const fieldMap = {
                'country': 'country',
                'gdp': 'gdp',
                'potential': 'potentialScore',
                'tam': 'tam',
                'enterprises': 'enterprises',
                'accredTime': 'accredMonths'
            };
            const sortField = fieldMap[field] || field;

            if (currentSort.field === sortField) {
                currentSort.desc = !currentSort.desc;
            } else {
                currentSort.field = sortField;
                currentSort.desc = true;
            }

            const sorted = [...countries].sort((a, b) => {
                let valA = a[sortField];
                let valB = b[sortField];
                if (typeof valA === 'string') {
                    return currentSort.desc ? valB.localeCompare(valA) : valA.localeCompare(valB);
                }
                return currentSort.desc ? valB - valA : valA - valB;
            });

            renderTable(sorted);

            // Update button styles
            document.querySelectorAll('.sort-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        function filterTable() {
            const filter = document.getElementById('searchBox').value.toLowerCase();
            const filtered = countries.filter(c =>
                c.country.toLowerCase().includes(filter) ||
                c.model.toLowerCase().includes(filter) ||
                c.taxAuth.toLowerCase().includes(filter)
            );
            renderTable(filtered);
        }

        function showMainSection(id) {
            document.querySelectorAll('.main-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.target.classList.add('active');
        }

        function showRegion(region) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(region).classList.add('active');
        }

        function renderTimelineGraph() {
            const container = document.getElementById('timelineVisual');
            const events = [
                { date: new Date('2025-01-01'), country: 'Germany', type: 'active', label: 'DE Receive' },
                { date: new Date('2025-04-01'), country: 'Jordan', type: 'active', label: 'Jordan' },
                { date: new Date('2025-07-01'), country: 'Malaysia', type: 'active', label: 'Malaysia' },
                { date: new Date('2025-11-01'), country: 'Singapore', type: 'active', label: 'Singapore' },
                { date: new Date('2025-12-01'), country: 'China', type: 'active', label: 'China' },
                { date: new Date('2026-01-01'), country: 'Belgium', type: 'pending', label: 'Belgium' },
                { date: new Date('2026-02-01'), country: 'Poland', type: 'pending', label: 'Poland' },
                { date: new Date('2026-07-01'), country: 'UAE', type: 'pending', label: 'UAE' },
                { date: new Date('2026-08-01'), country: 'Oman', type: 'pending', label: 'Oman' },
                { date: new Date('2026-09-01'), country: 'France', type: 'pending', label: 'France' },
                { date: new Date('2027-01-01'), country: 'Germany', type: 'pending', label: 'DE Send' },
                { date: new Date('2027-06-01'), country: 'Spain', type: 'pending', label: 'Spain' },
                { date: new Date('2027-09-01'), country: 'France', type: 'planned', label: 'FR SMEs' },
                { date: new Date('2030-07-01'), country: 'EU', type: 'planned', label: 'EU ViDA' },
            ];

            const startDate = new Date('2025-01-01');
            const endDate = new Date('2030-12-31');
            const totalMs = endDate - startDate;
            const width = container.offsetWidth - 80;

            // Draw axis
            let html = '<div class="timeline-axis"></div>';

            // Year marks
            for (let year = 2025; year <= 2030; year++) {
                const yearDate = new Date(`${year}-01-01`);
                const pos = ((yearDate - startDate) / totalMs) * width + 60;
                html += `<div class="timeline-year-mark" style="left:${pos}px">${year}</div>`;
            }

            // Events - stagger vertically to avoid overlap
            events.forEach((evt, i) => {
                const pos = ((evt.date - startDate) / totalMs) * width + 60;
                const row = i % 6;
                const bottom = 50 + row * 50;
                const dotClass = evt.type === 'active' ? 'dot-active' : evt.type === 'pending' ? 'dot-pending' : 'dot-planned';
                html += `<div class="timeline-item-dot ${dotClass}" style="left:${pos}px; bottom:${bottom}px" title="${evt.country}: ${evt.date.toLocaleDateString()}"></div>`;
                html += `<div class="timeline-item-label" style="left:${pos}px; bottom:${bottom + 18}px">${evt.label}</div>`;
            });

            container.innerHTML = html;
        }

        // Initialize
        renderTable(countries);
        setTimeout(renderTimelineGraph, 100);
    </script>
</body>
</html>
