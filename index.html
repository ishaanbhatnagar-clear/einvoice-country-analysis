<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global E-Invoicing Country Analysis</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif; line-height: 1.6; color: #333; background: #f5f7fa; padding: 20px; }
        .container { max-width: 1400px; margin: 0 auto; }
        h1 { color: #1a365d; margin-bottom: 10px; font-size: 2.2em; }
        h2 { color: #2d3748; margin: 30px 0 15px; padding-bottom: 10px; border-bottom: 2px solid #4299e1; }
        h3 { color: #4a5568; margin: 20px 0 10px; }
        .subtitle { color: #718096; margin-bottom: 30px; }

        /* Navigation */
        .main-nav { display: flex; gap: 10px; margin-bottom: 25px; flex-wrap: wrap; background: white; padding: 15px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
        .nav-btn { padding: 12px 24px; border: 2px solid #e2e8f0; border-radius: 25px; background: white; cursor: pointer; font-size: 0.95em; font-weight: 600; transition: all 0.3s; display: flex; align-items: center; gap: 8px; }
        .nav-btn:hover { border-color: #4299e1; background: #ebf8ff; }
        .nav-btn.active { background: #4299e1; color: white; border-color: #4299e1; }
        .nav-btn .icon { font-size: 1.1em; }

        .main-section { display: none; }
        .main-section.active { display: block; }

        /* Stats Grid */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .stat-card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); text-align: center; }
        .stat-number { font-size: 2.5em; font-weight: 700; color: #4299e1; }
        .stat-label { color: #718096; font-size: 0.9em; }

        /* Tables */
        table { width: 100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 30px; }
        th { background: #2d3748; color: white; padding: 12px 10px; text-align: left; font-weight: 600; font-size: 0.85em; }
        td { padding: 10px; border-bottom: 1px solid #e2e8f0; font-size: 0.9em; }
        tr:hover { background: #f7fafc; }
        tr:last-child td { border-bottom: none; }

        /* Status Badges */
        .status { padding: 3px 8px; border-radius: 12px; font-size: 0.75em; font-weight: 600; }
        .status-active { background: #c6f6d5; color: #276749; }
        .status-pending { background: #fef3c7; color: #92400e; }
        .status-planned { background: #e9d8fd; color: #553c9a; }
        .status-voluntary { background: #e2e8f0; color: #4a5568; }

        /* Potential Badges */
        .potential { padding: 3px 8px; border-radius: 12px; font-size: 0.75em; font-weight: 600; }
        .potential-very-high { background: #fed7d7; color: #c53030; }
        .potential-high { background: #feebc8; color: #c05621; }
        .potential-medium { background: #bee3f8; color: #2b6cb0; }
        .potential-low { background: #e2e8f0; color: #4a5568; }
        .potential-saturated { background: #c6f6d5; color: #276749; }
        .potential-mature { background: #e9d8fd; color: #553c9a; }
        .status-phased { background: #feebc8; color: #c05621; }

        /* Legend Box */
        .legend-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin-bottom: 25px; }
        .legend-box { background: white; border-radius: 10px; padding: 15px 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
        .legend-box h4 { color: #2d3748; font-size: 0.95em; margin-bottom: 10px; border-bottom: 1px solid #e2e8f0; padding-bottom: 8px; }
        .legend-item { display: flex; align-items: flex-start; margin-bottom: 6px; font-size: 0.82em; }
        .legend-item:last-child { margin-bottom: 0; }
        .legend-item .badge { min-width: 80px; margin-right: 10px; }
        .legend-item .desc { color: #4a5568; }

        /* Region Tabs */
        .tabs { display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 20px; }
        .tab { padding: 8px 16px; background: #e2e8f0; border: none; border-radius: 20px; cursor: pointer; font-size: 0.9em; transition: all 0.2s; }
        .tab:hover { background: #cbd5e0; }
        .tab.active { background: #4299e1; color: white; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        /* Search */
        .search-box { width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 1em; margin-bottom: 20px; }
        .search-box:focus { outline: none; border-color: #4299e1; }

        /* Timeline */
        .timeline { background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
        .timeline-year { font-size: 1.3em; font-weight: 700; color: #4299e1; margin: 20px 0 10px; }
        .timeline-item { display: flex; padding: 8px 0; border-bottom: 1px solid #e2e8f0; }
        .timeline-date { width: 100px; font-weight: 600; color: #4a5568; }
        .timeline-country { width: 120px; font-weight: 600; }
        .timeline-desc { flex: 1; color: #718096; }

        /* Compare Section */
        .compare-box { background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 25px; }
        .compare-intro { background: linear-gradient(135deg, #ebf8ff, #e6fffa); border-radius: 10px; padding: 20px; margin-bottom: 20px; }
        .compare-intro p { color: #2d3748; margin: 0; }

        .country-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 10px; margin-bottom: 20px; }
        .country-btn { padding: 10px 12px; border: 2px solid #e2e8f0; border-radius: 8px; background: white; cursor: pointer; font-size: 0.85em; transition: all 0.2s; display: flex; align-items: center; gap: 6px; }
        .country-btn:hover { border-color: #4299e1; background: #ebf8ff; }
        .country-btn.selected { border-color: #4299e1; background: #4299e1; color: white; }
        .country-btn .flag { font-size: 1.1em; }

        .action-row { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; align-items: center; }
        .action-btn { padding: 10px 20px; border: none; border-radius: 20px; font-size: 0.9em; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .btn-compare { background: #4299e1; color: white; }
        .btn-compare:hover { background: #3182ce; }
        .btn-clear { background: #e2e8f0; color: #4a5568; }
        .btn-clear:hover { background: #cbd5e0; }
        .btn-preset { background: #f0fff4; color: #276749; border: 1px solid #9ae6b4; }
        .btn-preset:hover { background: #c6f6d5; }
        .count-badge { padding: 8px 16px; background: #ebf8ff; color: #2b6cb0; border-radius: 20px; font-weight: 600; font-size: 0.9em; }

        .compare-result { display: none; }
        .compare-result.active { display: block; }

        .compare-cards { display: grid; gap: 20px; margin-bottom: 20px; }
        .compare-card { background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1); border: 1px solid #e2e8f0; }
        .compare-card-header { background: linear-gradient(135deg, #4299e1, #3182ce); color: white; padding: 16px 20px; display: flex; align-items: center; gap: 12px; }
        .compare-card-header .flag { font-size: 1.8em; }
        .compare-card-header .name { font-size: 1.2em; font-weight: 700; }
        .compare-card-header .remove { margin-left: auto; background: rgba(255,255,255,0.2); border: none; color: white; width: 26px; height: 26px; border-radius: 50%; cursor: pointer; font-size: 1em; }
        .compare-card-header .remove:hover { background: rgba(255,255,255,0.3); }
        .compare-card-body { padding: 18px; }

        .info-section { margin-bottom: 16px; }
        .info-section:last-child { margin-bottom: 0; }
        .info-section-title { font-size: 0.7em; text-transform: uppercase; letter-spacing: 1px; color: #718096; margin-bottom: 8px; font-weight: 700; }
        .info-row { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid #f7fafc; }
        .info-row:last-child { border-bottom: none; }
        .info-label { color: #718096; font-size: 0.85em; }
        .info-value { font-weight: 600; color: #2d3748; font-size: 0.85em; text-align: right; max-width: 55%; }

        .insights-panel { background: #f0fff4; border-radius: 10px; padding: 20px; margin-bottom: 20px; border: 1px solid #9ae6b4; }
        .insights-panel h3 { color: #276749; font-size: 1em; margin-bottom: 15px; }
        .insight-list { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 12px; }
        .insight-item { background: white; padding: 14px; border-radius: 8px; border-left: 4px solid #48bb78; }
        .insight-item-title { font-weight: 600; font-size: 0.9em; color: #276749; margin-bottom: 4px; }
        .insight-item-text { font-size: 0.82em; color: #4a5568; }

        .empty-state { text-align: center; padding: 40px 20px; background: #f7fafc; border-radius: 10px; }
        .empty-state .icon { font-size: 3em; margin-bottom: 15px; }
        .empty-state .title { font-size: 1.1em; font-weight: 600; color: #2d3748; margin-bottom: 6px; }
        .empty-state .text { color: #718096; font-size: 0.9em; }

        /* Footer */
        .footer { margin-top: 40px; padding: 20px; text-align: center; color: #718096; font-size: 0.85em; }

        /* Ticker */
        .ticker-wrap { width: 100%; overflow: hidden; background: linear-gradient(90deg, #2d3748, #4a5568); padding: 10px 0; margin-bottom: 20px; border-radius: 8px; }
        .ticker { display: inline-block; white-space: nowrap; animation: ticker 20s linear infinite; }
        .ticker-item { display: inline-block; padding: 0 50px; color: #fbd38d; font-weight: 600; font-size: 0.9em; }
        .ticker-item span { color: #fff; }
        @keyframes ticker { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        /* Players badge */
        .players { font-size: 0.8em; color: #4a5568; }
        .players strong { color: #2b6cb0; }

        @media (max-width: 768px) {
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            table { font-size: 0.8em; }
            th, td { padding: 8px 5px; }
            .country-grid { grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); }
            .main-nav { gap: 8px; }
            .nav-btn { padding: 10px 16px; font-size: 0.85em; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Running Ticker Disclaimer -->
        <div class="ticker-wrap">
            <div class="ticker">
                <div class="ticker-item">‚ö†Ô∏è <span>DISCLAIMER:</span> This knowledge base is created as of 6 Jan 2025. Data may have changed since then.</div>
                <div class="ticker-item">üìä <span>Sources:</span> IMF, VATupdate, KPMG, Basware, Storecove, EDICOM, Fonoa</div>
                <div class="ticker-item">‚ö†Ô∏è <span>DISCLAIMER:</span> This knowledge base is created as of 6 Jan 2025. Data may have changed since then.</div>
            </div>
        </div>

        <h1>Global E-Invoicing Country Analysis</h1>
        <p class="subtitle">GDP, E-Invoice Potential & Mandate Dates | Top Players & Market Penetration</p>

        <!-- Main Navigation -->
        <div class="main-nav">
            <button class="nav-btn active" onclick="showMainSection('overview')"><span class="icon">üìä</span> Overview</button>
            <button class="nav-btn" onclick="showMainSection('compare')"><span class="icon">üîÑ</span> Compare Countries</button>
            <button class="nav-btn" onclick="showMainSection('timeline')"><span class="icon">üìÖ</span> Timeline</button>
            <button class="nav-btn" onclick="showMainSection('regions')"><span class="icon">üåç</span> By Region</button>
        </div>

        <!-- Section: Overview -->
        <div id="overview" class="main-section active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">79</div>
                    <div class="stat-label">Countries Analyzed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">45+</div>
                    <div class="stat-label">Active Mandates</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">$70T+</div>
                    <div class="stat-label">Total GDP Covered</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">8</div>
                    <div class="stat-label">Very High Potential Markets</div>
                </div>
            </div>

            <input type="text" class="search-box" id="searchBox" placeholder="Search countries..." onkeyup="filterTable()">

            <!-- Legend Boxes -->
            <div class="legend-container">
                <div class="legend-box">
                    <h4>üìä Potential Rating Criteria</h4>
                    <div class="legend-item"><span class="badge"><span class="potential potential-very-high">Very High</span></span><span class="desc">GDP &gt;$1T + New/upcoming mandate (high growth opportunity)</span></div>
                    <div class="legend-item"><span class="badge"><span class="potential potential-high">High</span></span><span class="desc">GDP $300B-$1T OR established mandate with growth room</span></div>
                    <div class="legend-item"><span class="badge"><span class="potential potential-medium">Medium</span></span><span class="desc">GDP $100B-$300B OR niche market opportunity</span></div>
                    <div class="legend-item"><span class="badge"><span class="potential potential-mature">Mature</span></span><span class="desc">Mandate 5+ years; compliance saturated but value-add services opportunity</span></div>
                    <div class="legend-item"><span class="badge"><span class="potential potential-low">Low</span></span><span class="desc">GDP &lt;$100B with limited e-invoice adoption</span></div>
                </div>
                <div class="legend-box">
                    <h4>üè¢ Model Types Glossary</h4>
                    <div class="legend-item"><strong style="min-width:80px;">Clearance</strong><span class="desc">Invoice must be approved by tax authority BEFORE being sent to buyer</span></div>
                    <div class="legend-item"><strong style="min-width:80px;">RTIR</strong><span class="desc">Real-Time Invoice Reporting - reported to authority in real-time/near real-time</span></div>
                    <div class="legend-item"><strong style="min-width:80px;">CTC</strong><span class="desc">Continuous Transaction Controls - ongoing digital reporting to authorities</span></div>
                    <div class="legend-item"><strong style="min-width:80px;">Peppol</strong><span class="desc">Open network standard for B2B/B2G document exchange (4-corner model)</span></div>
                    <div class="legend-item"><strong style="min-width:80px;">Hybrid</strong><span class="desc">Combination of models (e.g., France PPF+PDP = Gov platform + private platforms)</span></div>
                    <div class="legend-item"><strong style="min-width:80px;">ViDA</strong><span class="desc">EU VAT in the Digital Age - EU-wide e-invoicing/reporting mandate from Jul 2030</span></div>
                </div>
                <div class="legend-box">
                    <h4>üìà Top Players % = Estimated Captured Market Share</h4>
                    <div class="legend-item"><span class="desc">Percentages represent the <strong>estimated share of e-invoicing transactions</strong> processed by each provider in that country. These are industry estimates based on public data, analyst reports, and market research. "(Gov)" indicates government-operated platforms.</span></div>
                </div>
            </div>

            <h2>Master Table (Sorted by Mandate Date)</h2>
            <table id="masterTable">
                <thead>
                    <tr><th>#</th><th>Country</th><th>GDP</th><th>Potential</th><th>Mandate</th><th>Status</th><th>Prominent Providers (Est. Share)</th></tr>
                </thead>
                <tbody>
                    <tr><td>1</td><td><strong>Brazil</strong></td><td>$2,170B</td><td><span class="potential potential-mature">Mature</span></td><td>2008</td><td><span class="status status-active">Active</span></td><td class="players"><strong>Sovos</strong> 25%, <strong>EDICOM</strong> 18%, <strong>Sefaz</strong> (Gov)</td></tr>
                    <tr><td>2</td><td><strong>Mexico</strong></td><td>$1,470B</td><td><span class="potential potential-mature">Mature</span></td><td>2010</td><td><span class="status status-active">Active</span></td><td class="players"><strong>Edicom</strong> 20%, <strong>Sovos</strong> 15%, <strong>SAT PACs</strong> (Gov)</td></tr>
                    <tr><td>3</td><td><strong>South Korea</strong></td><td>$1,710B</td><td><span class="potential potential-mature">Mature</span></td><td>2011</td><td><span class="status status-active">Active</span></td><td class="players"><strong>NTS</strong> (Gov) 80%, <strong>Biztax</strong> 10%</td></tr>
                    <tr><td>4</td><td><strong>Chile</strong></td><td>$340B</td><td><span class="potential potential-mature">Mature</span></td><td>2014</td><td><span class="status status-active">Active</span></td><td class="players"><strong>SII</strong> (Gov), <strong>Sovos</strong> 20%, <strong>Acepta</strong> 15%</td></tr>
                    <tr><td>5</td><td><strong>Turkey</strong></td><td>$1,110B</td><td><span class="potential potential-mature">Mature</span></td><td>2014</td><td><span class="status status-active">Active</span></td><td class="players"><strong>Foriba</strong> 30%, <strong>Logo</strong> 20%, <strong>EDICOM</strong> 12%</td></tr>
                    <tr><td>6</td><td><strong>Hungary</strong></td><td>$210B</td><td><span class="potential potential-mature">Mature</span></td><td>2018</td><td><span class="status status-active">Active</span></td><td class="players"><strong>NAV</strong> (Gov), <strong>Ecosio</strong> 15%, <strong>Comarch</strong> 12%</td></tr>
                    <tr><td>7</td><td><strong>Italy</strong></td><td>$2,250B</td><td><span class="potential potential-high">High</span></td><td>2019</td><td><span class="status status-active">Active</span></td><td class="players"><strong>Aruba PEC</strong> 25%, <strong>TeamSystem</strong> 20%, <strong>Wolters Kluwer</strong> 12%</td></tr>
                    <tr><td>8</td><td><strong>India</strong></td><td>$3,730B</td><td><span class="potential potential-very-high">Very High</span></td><td>2020</td><td><span class="status status-active">Active</span></td><td class="players"><strong>ClearTax</strong> 35%, <strong>Vayana</strong> 20%, <strong>Cygnet</strong> 15%</td></tr>
                    <tr><td>9</td><td><strong>Saudi Arabia</strong></td><td>$1,070B</td><td><span class="potential potential-very-high">Very High</span></td><td>2021</td><td><span class="status status-active">Active</span></td><td class="players"><strong>Sovos</strong> 22%, <strong>EDICOM</strong> 18%, <strong>Comarch</strong> 10%</td></tr>
                    <tr><td>10</td><td><strong>Vietnam</strong></td><td>$450B</td><td><span class="potential potential-high">High</span></td><td>2022</td><td><span class="status status-active">Active</span></td><td class="players"><strong>MISA</strong> 30%, <strong>Viettel</strong> 25%, <strong>FPT</strong> 15%</td></tr>
                    <tr><td>11</td><td><strong>Romania</strong></td><td>$350B</td><td><span class="potential potential-high">High</span></td><td>Jan 2024</td><td><span class="status status-active">Active</span></td><td class="players"><strong>ANAF</strong> (Gov), <strong>Postis</strong> 18%, <strong>SoftOne</strong> 12%</td></tr>
                    <tr><td>12</td><td><strong>Germany</strong></td><td>$4,520B</td><td><span class="potential potential-very-high">Very High</span></td><td>2025-2028</td><td><span class="status status-phased">Phased</span></td><td class="players"><strong>SAP</strong> 30%, <strong>Pagero</strong> 15%, <strong>Basware</strong> 12%</td></tr>
                    <tr><td>13</td><td><strong>Malaysia</strong></td><td>$430B</td><td><span class="potential potential-high">High</span></td><td>Jul 2025</td><td><span class="status status-active">Active</span></td><td class="players"><strong>LHDN</strong> (Gov), <strong>Storecove</strong> 12%, <strong>TradeCentric</strong> 8%</td></tr>
                    <tr><td>14</td><td><strong>Singapore</strong></td><td>$500B</td><td><span class="potential potential-high">High</span></td><td>Nov 2025</td><td><span class="status status-active">Active</span></td><td class="players"><strong>InvoiceNow</strong> (Gov), <strong>Storecove</strong> 15%, <strong>Pagero</strong> 12%</td></tr>
                    <tr><td>15</td><td><strong>China</strong></td><td>$17,960B</td><td><span class="potential potential-very-high">Very High</span></td><td>Late 2025</td><td><span class="status status-active">Active</span></td><td class="players"><strong>Baiwang</strong> 35%, <strong>Aisino</strong> 30%, <strong>Nuonuo</strong> 20%</td></tr>
                    <tr><td>16</td><td><strong>Indonesia</strong></td><td>$1,390B</td><td><span class="potential potential-very-high">Very High</span></td><td>2025-2026</td><td><span class="status status-active">Active</span></td><td class="players"><strong>DJP</strong> (Gov), <strong>OnlinePajak</strong> 20%, <strong>Klikpajak</strong> 15%</td></tr>
                    <tr><td>17</td><td><strong>Belgium</strong></td><td>$630B</td><td><span class="potential potential-high">High</span></td><td>Jan 2026</td><td><span class="status status-pending">Pending</span></td><td class="players"><strong>Peppol APs</strong>, <strong>Basware</strong> 15%, <strong>Pagero</strong> 12%</td></tr>
                    <tr><td>18</td><td><strong>Poland</strong></td><td>$750B</td><td><span class="potential potential-high">High</span></td><td>Feb 2026</td><td><span class="status status-pending">Pending</span></td><td class="players"><strong>KSeF</strong> (Gov), <strong>Comarch</strong> 25%, <strong>Asseco</strong> 15%</td></tr>
                    <tr><td>19</td><td><strong>UAE</strong></td><td>$500B</td><td><span class="potential potential-high">High</span></td><td>Jul 2026</td><td><span class="status status-pending">Pending</span></td><td class="players"><strong>Sovos</strong> 20%, <strong>EDICOM</strong> 15%, <strong>Pagero</strong> 10%</td></tr>
                    <tr><td>20</td><td><strong>Oman</strong></td><td>$115B</td><td><span class="potential potential-medium">Medium</span></td><td>Aug 2026 (Top 100), Feb 2027 (All)</td><td><span class="status status-pending">Pending</span></td><td class="players"><strong>Peppol APs</strong>, <strong>Storecove</strong> 10%, <strong>TBD</strong></td></tr>
                    <tr><td>21</td><td><strong>France</strong></td><td>$3,030B</td><td><span class="potential potential-very-high">Very High</span></td><td>Sep 2026</td><td><span class="status status-pending">Pending</span></td><td class="players"><strong>Chorus Pro</strong> (Gov), <strong>Generix</strong> 15%, <strong>Cegedim</strong> 12%</td></tr>
                    <tr><td>22</td><td><strong>Philippines</strong></td><td>$440B</td><td><span class="potential potential-high">High</span></td><td>Dec 2026</td><td><span class="status status-pending">Pending</span></td><td class="players"><strong>BIR</strong> (Gov), <strong>Oracle NetSuite</strong> 12%, <strong>Local ERPs</strong></td></tr>
                    <tr><td>23</td><td><strong>Spain</strong></td><td>$1,580B</td><td><span class="potential potential-very-high">Very High</span></td><td>2027</td><td><span class="status status-pending">Pending</span></td><td class="players"><strong>EDICOM</strong> 25%, <strong>Seres</strong> 18%, <strong>B2Brouter</strong> 10%</td></tr>
                    <tr><td>24</td><td><strong>Thailand</strong></td><td>$510B</td><td><span class="potential potential-high">High</span></td><td>2027-2028</td><td><span class="status status-planned">Planned</span></td><td class="players"><strong>RD</strong> (Gov), <strong>Ricoh</strong> 10%, <strong>TBD</strong></td></tr>
                    <tr><td>25</td><td><strong>Ireland</strong></td><td>$530B</td><td><span class="potential potential-high">High</span></td><td>Nov 2028</td><td><span class="status status-planned">Planned</span></td><td class="players"><strong>Peppol APs</strong>, <strong>Pagero</strong> 12%, <strong>Basware</strong> 10%</td></tr>
                    <tr><td>26</td><td><strong>Netherlands</strong></td><td>$1,090B</td><td><span class="potential potential-high">High</span></td><td>Jul 2030</td><td><span class="status status-planned">Planned (ViDA)</span></td><td class="players"><strong>Peppol APs</strong>, <strong>Storecove</strong> 18%, <strong>Basware</strong> 15%</td></tr>
                    <tr><td>27</td><td><strong>Sweden</strong></td><td>$590B</td><td><span class="potential potential-high">High</span></td><td>Jul 2030</td><td><span class="status status-planned">Planned (ViDA)</span></td><td class="players"><strong>Peppol APs</strong>, <strong>Pagero</strong> 25%, <strong>Basware</strong> 15%</td></tr>
                    <tr><td>28</td><td><strong>Norway</strong></td><td>$485B</td><td><span class="potential potential-high">High</span></td><td>Jul 2030</td><td><span class="status status-planned">Planned (ViDA)</span></td><td class="players"><strong>Peppol APs</strong>, <strong>Pagero</strong> 22%, <strong>Visma</strong> 18%</td></tr>
                    <tr><td>29</td><td><strong>Japan</strong></td><td>$4,230B</td><td><span class="potential potential-very-high">Very High</span></td><td>QIS 2023</td><td><span class="status status-voluntary">Voluntary (QIS)</span></td><td class="players"><strong>TKC</strong> 15%, <strong>Freee</strong> 12%, <strong>SAP</strong> 10%</td></tr>
                    <tr><td>30</td><td><strong>Australia</strong></td><td>$1,720B</td><td><span class="potential potential-high">High</span></td><td>No mandate</td><td><span class="status status-voluntary">Voluntary</span></td><td class="players"><strong>Peppol APs</strong>, <strong>Link4</strong> 18%, <strong>MessageXchange</strong> 15%</td></tr>
                </tbody>
            </table>

            <h2>Top Growth Opportunity Markets (by Potential)</h2>
            <table>
                <thead><tr><th>Rank</th><th>Country</th><th>GDP (USD Bn)</th><th>Status</th><th>Potential</th></tr></thead>
                <tbody>
                    <tr><td>1</td><td><strong>China</strong></td><td>$17,960</td><td><span class="status status-active">Active</span></td><td><span class="potential potential-very-high">Very High</span></td></tr>
                    <tr><td>2</td><td><strong>Germany</strong></td><td>$4,520</td><td><span class="status status-active">Active</span></td><td><span class="potential potential-very-high">Very High</span></td></tr>
                    <tr><td>3</td><td><strong>Japan</strong></td><td>$4,230</td><td><span class="status status-voluntary">Voluntary</span></td><td><span class="potential potential-very-high">Very High</span></td></tr>
                    <tr><td>4</td><td><strong>India</strong></td><td>$3,730</td><td><span class="status status-active">Active</span></td><td><span class="potential potential-very-high">Very High</span></td></tr>
                    <tr><td>5</td><td><strong>France</strong></td><td>$3,030</td><td><span class="status status-pending">Pending</span></td><td><span class="potential potential-very-high">Very High</span></td></tr>
                    <tr><td>6</td><td><strong>Spain</strong></td><td>$1,580</td><td><span class="status status-pending">Pending</span></td><td><span class="potential potential-very-high">Very High</span></td></tr>
                    <tr><td>7</td><td><strong>Indonesia</strong></td><td>$1,390</td><td><span class="status status-active">Active</span></td><td><span class="potential potential-very-high">Very High</span></td></tr>
                    <tr><td>8</td><td><strong>Saudi Arabia</strong></td><td>$1,070</td><td><span class="status status-active">Active</span></td><td><span class="potential potential-very-high">Very High</span></td></tr>
                    <tr><td>9</td><td><strong>Italy</strong></td><td>$2,250</td><td><span class="status status-active">Active</span></td><td><span class="potential potential-high">High</span></td></tr>
                    <tr><td>10</td><td><strong>Australia</strong></td><td>$1,720</td><td><span class="status status-voluntary">Voluntary</span></td><td><span class="potential potential-high">High</span></td></tr>
                </tbody>
            </table>

            <h2>Key Voluntary Markets (No Mandate)</h2>
            <table>
                <thead><tr><th>Country</th><th>GDP</th><th>E-Invoice Status</th><th>Key Initiative</th><th>Prominent Providers</th></tr></thead>
                <tbody>
                    <tr><td><strong>United States</strong></td><td>$27,360B</td><td><span class="status status-voluntary">Voluntary</span></td><td>DBNAlliance (B2B Network)</td><td class="players"><strong>Coupa</strong>, <strong>SAP Ariba</strong>, <strong>Tradeshift</strong></td></tr>
                    <tr><td><strong>United Kingdom</strong></td><td>$3,340B</td><td><span class="status status-voluntary">Voluntary (B2G Active)</span></td><td>Peppol adoption for B2G</td><td class="players"><strong>Pagero</strong>, <strong>Tungsten</strong>, <strong>Basware</strong></td></tr>
                    <tr><td><strong>Canada</strong></td><td>$2,140B</td><td><span class="status status-voluntary">Voluntary</span></td><td>No federal initiative</td><td class="players"><strong>SAP Ariba</strong>, <strong>Coupa</strong>, <strong>Tradeshift</strong></td></tr>
                </tbody>
            </table>
        </div>

        <!-- Section: Compare Countries -->
        <div id="compare" class="main-section">
            <div class="compare-box">
                <h2 style="margin-top:0;">Compare Countries</h2>
                <div class="compare-intro">
                    <p>Select 2-5 countries to compare their e-invoicing mandates, GDP, potential, status, and models side-by-side.</p>
                </div>

                <div class="country-grid" id="countryGrid"></div>

                <div class="action-row">
                    <span class="count-badge" id="countBadge">0 selected</span>
                    <button class="action-btn btn-compare" onclick="runCompare()">Compare Selected</button>
                    <button class="action-btn btn-clear" onclick="clearCompare()">Clear All</button>
                    <button class="action-btn btn-preset" onclick="preset('brics')">BRICS+</button>
                    <button class="action-btn btn-preset" onclick="preset('eu')">EU Big 5</button>
                    <button class="action-btn btn-preset" onclick="preset('apac')">APAC</button>
                    <button class="action-btn btn-preset" onclick="preset('mena')">MENA</button>
                </div>

                <div id="emptyCompare" class="empty-state">
                    <div class="icon">üîÑ</div>
                    <div class="title">Select Countries to Compare</div>
                    <div class="text">Choose 2-5 countries and click "Compare Selected"</div>
                </div>

                <div id="compareResult" class="compare-result">
                    <div id="insightsPanel" class="insights-panel">
                        <h3>Quick Insights</h3>
                        <div class="insight-list" id="insightList"></div>
                    </div>
                    <div class="compare-cards" id="compareCards"></div>
                </div>
            </div>
        </div>

        <!-- Section: Timeline -->
        <div id="timeline" class="main-section">
            <h2>Key Upcoming Deadlines (2025-2027)</h2>
            <div class="timeline">
                <div class="timeline-year">2025</div>
                <div class="timeline-item"><div class="timeline-date">Jan 2025</div><div class="timeline-country">Germany</div><div class="timeline-desc">RECEIVE mandate active (must accept e-invoices)</div></div>
                <div class="timeline-item"><div class="timeline-date">Jan 2025</div><div class="timeline-country">Israel</div><div class="timeline-desc">Clearance begins</div></div>
                <div class="timeline-item"><div class="timeline-date">Apr 2025</div><div class="timeline-country">Jordan</div><div class="timeline-desc">Full mandate (JoFotara)</div></div>
                <div class="timeline-item"><div class="timeline-date">Jul 2025</div><div class="timeline-country">Malaysia</div><div class="timeline-desc">Large taxpayers</div></div>
                <div class="timeline-item"><div class="timeline-date">Nov 2025</div><div class="timeline-country">Singapore</div><div class="timeline-desc">InvoiceNow Phase 1</div></div>
                <div class="timeline-item"><div class="timeline-date">Dec 2025</div><div class="timeline-country">China</div><div class="timeline-desc">Nationwide mandate</div></div>

                <div class="timeline-year">2026</div>
                <div class="timeline-item"><div class="timeline-date">Jan 2026</div><div class="timeline-country">Belgium</div><div class="timeline-desc">Full B2B mandate (Peppol)</div></div>
                <div class="timeline-item"><div class="timeline-date">Jan 2026</div><div class="timeline-country">Malaysia</div><div class="timeline-desc">SMEs</div></div>
                <div class="timeline-item"><div class="timeline-date">Feb 2026</div><div class="timeline-country">Poland</div><div class="timeline-desc">Large taxpayers (KSeF)</div></div>
                <div class="timeline-item"><div class="timeline-date">Apr 2026</div><div class="timeline-country">Poland</div><div class="timeline-desc">All taxpayers</div></div>
                <div class="timeline-item"><div class="timeline-date">Jun 2026</div><div class="timeline-country">Saudi Arabia</div><div class="timeline-desc">Final FATOORA phase</div></div>
                <div class="timeline-item"><div class="timeline-date">Jul 2026</div><div class="timeline-country">UAE</div><div class="timeline-desc">Pilot begins</div></div>
                <div class="timeline-item"><div class="timeline-date">Aug 2026</div><div class="timeline-country">Oman</div><div class="timeline-desc">Pilot for Top 100 (Peppol); Full mandate Feb 2027</div></div>
                <div class="timeline-item"><div class="timeline-date">Sep 2026</div><div class="timeline-country">France</div><div class="timeline-desc">Large/mid-size companies</div></div>
                <div class="timeline-item"><div class="timeline-date">Dec 2026</div><div class="timeline-country">Philippines</div><div class="timeline-desc">Full mandate</div></div>

                <div class="timeline-year">2027</div>
                <div class="timeline-item"><div class="timeline-date">Jan 2027</div><div class="timeline-country">Germany</div><div class="timeline-desc">SEND mandate (>‚Ç¨800k turnover); Jan 2028 for all</div></div>
                <div class="timeline-item"><div class="timeline-date">Jan 2027</div><div class="timeline-country">UAE</div><div class="timeline-desc">Large companies</div></div>
                <div class="timeline-item"><div class="timeline-date">Sep 2027</div><div class="timeline-country">France</div><div class="timeline-desc">SMEs</div></div>
                <div class="timeline-item"><div class="timeline-date">2027</div><div class="timeline-country">Spain</div><div class="timeline-desc">Large businesses (Verifactu)</div></div>
            </div>
        </div>

        <!-- Section: By Region -->
        <div id="regions" class="main-section">
            <h2>Regional Breakdown</h2>
            <div class="tabs">
                <button class="tab active" onclick="showRegion('europe')">Europe</button>
                <button class="tab" onclick="showRegion('asia')">Asia-Pacific</button>
                <button class="tab" onclick="showRegion('middle-east')">Middle East</button>
                <button class="tab" onclick="showRegion('latam')">Latin America</button>
                <button class="tab" onclick="showRegion('africa')">Africa</button>
            </div>

            <div id="europe" class="tab-content active">
                <table>
                    <thead><tr><th>Country</th><th>GDP</th><th>Mandate</th><th>Model</th></tr></thead>
                    <tbody>
                        <tr><td>Italy</td><td>$2,250B</td><td>2019</td><td>Clearance (SdI)</td></tr>
                        <tr><td>Hungary</td><td>$210B</td><td>2018</td><td>RTIR (NAV)</td></tr>
                        <tr><td>Romania</td><td>$350B</td><td>Jan 2024</td><td>RTIR</td></tr>
                        <tr><td>Germany</td><td>$4,520B</td><td>2025 (Receive), 2027-28 (Send)</td><td>Flexible (EN 16931)</td></tr>
                        <tr><td>Belgium</td><td>$630B</td><td>Jan 2026</td><td>Peppol</td></tr>
                        <tr><td>Poland</td><td>$750B</td><td>Feb 2026</td><td>KSeF</td></tr>
                        <tr><td>France</td><td>$3,030B</td><td>Sep 2026</td><td>Hybrid (PPF+PDP)</td></tr>
                        <tr><td>Spain</td><td>$1,580B</td><td>2027</td><td>Verifactu</td></tr>
                        <tr><td>Netherlands</td><td>$1,090B</td><td>Jul 2030</td><td>Peppol (ViDA)</td></tr>
                    </tbody>
                </table>
            </div>
            <div id="asia" class="tab-content">
                <table>
                    <thead><tr><th>Country</th><th>GDP</th><th>Mandate</th><th>Model</th></tr></thead>
                    <tbody>
                        <tr><td>China</td><td>$17,960B</td><td>Late 2025</td><td>Golden Tax</td></tr>
                        <tr><td>India</td><td>$3,730B</td><td>2020</td><td>GST e-Invoice</td></tr>
                        <tr><td>Japan</td><td>$4,230B</td><td>Voluntary</td><td>Peppol</td></tr>
                        <tr><td>South Korea</td><td>$1,710B</td><td>2011</td><td>RTIR</td></tr>
                        <tr><td>Indonesia</td><td>$1,390B</td><td>2025-2026</td><td>Coretax</td></tr>
                        <tr><td>Singapore</td><td>$500B</td><td>Nov 2025</td><td>Peppol</td></tr>
                        <tr><td>Malaysia</td><td>$430B</td><td>Jul 2025</td><td>MyInvois</td></tr>
                        <tr><td>Philippines</td><td>$440B</td><td>Dec 2026</td><td>CTC</td></tr>
                        <tr><td>Thailand</td><td>$510B</td><td>2027-2028</td><td>TBD</td></tr>
                    </tbody>
                </table>
            </div>
            <div id="middle-east" class="tab-content">
                <table>
                    <thead><tr><th>Country</th><th>GDP</th><th>Mandate</th><th>Model</th></tr></thead>
                    <tbody>
                        <tr><td>Saudi Arabia</td><td>$1,070B</td><td>2021-2026</td><td>FATOORA</td></tr>
                        <tr><td>Turkey</td><td>$1,110B</td><td>2014</td><td>GIB</td></tr>
                        <tr><td>UAE</td><td>$500B</td><td>Jul 2026</td><td>Clearance</td></tr>
                        <tr><td>Israel</td><td>$520B</td><td>2025-2026</td><td>SHAAM</td></tr>
                        <tr><td>Oman</td><td>$115B</td><td>Aug 2026 (Top 100), Feb 2027 (All)</td><td>Peppol 5-corner</td></tr>
                        <tr><td>Jordan</td><td>$50B</td><td>Apr 2025</td><td>JoFotara</td></tr>
                        <tr><td>Egypt</td><td>$400B</td><td>2020-2025</td><td>ETA Clearance</td></tr>
                    </tbody>
                </table>
            </div>
            <div id="latam" class="tab-content">
                <table>
                    <thead><tr><th>Country</th><th>GDP</th><th>Mandate</th><th>Model</th></tr></thead>
                    <tbody>
                        <tr><td>Brazil</td><td>$2,170B</td><td>2008</td><td>NF-e</td></tr>
                        <tr><td>Mexico</td><td>$1,470B</td><td>2010</td><td>CFDI</td></tr>
                        <tr><td>Argentina</td><td>$640B</td><td>Active</td><td>AFIP</td></tr>
                        <tr><td>Chile</td><td>$340B</td><td>2014</td><td>Clearance</td></tr>
                        <tr><td>Colombia</td><td>$340B</td><td>2018</td><td>Clearance</td></tr>
                        <tr><td>Peru</td><td>$270B</td><td>2014</td><td>Clearance</td></tr>
                    </tbody>
                </table>
            </div>
            <div id="africa" class="tab-content">
                <table>
                    <thead><tr><th>Country</th><th>GDP</th><th>Mandate</th><th>Model</th></tr></thead>
                    <tbody>
                        <tr><td>Nigeria</td><td>$475B</td><td>Nov 2025</td><td>Clearance</td></tr>
                        <tr><td>Egypt</td><td>$400B</td><td>2020-2025</td><td>ETA</td></tr>
                        <tr><td>Kenya</td><td>$110B</td><td>2020</td><td>eTIMS</td></tr>
                        <tr><td>Ghana</td><td>$80B</td><td>Oct 2022</td><td>Fiscal Device</td></tr>
                        <tr><td>Tunisia</td><td>$50B</td><td>2016</td><td>TTN</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="footer">
            <p><strong>Sources:</strong> IMF, VATupdate, KPMG, Basware, Storecove, EDICOM, Fonoa</p>
            <p>GDP figures are 2024/2025 estimates. Mandate dates may change. Market share figures are estimates based on industry research.</p>
            <p><strong>Knowledge Base Created:</strong> 6 January 2025</p>
        </div>
    </div>

    <script>
        const countryData = {
            'BR': { name: 'Brazil', flag: 'üáßüá∑', gdp: '$2,170B', potential: 'Mature', mandate: '2008', status: 'Active', model: 'Clearance (NF-e)', region: 'LATAM' },
            'MX': { name: 'Mexico', flag: 'üá≤üáΩ', gdp: '$1,470B', potential: 'Mature', mandate: '2010', status: 'Active', model: 'Clearance (CFDI)', region: 'LATAM' },
            'KR': { name: 'South Korea', flag: 'üá∞üá∑', gdp: '$1,710B', potential: 'Mature', mandate: '2011', status: 'Active', model: 'RTIR', region: 'APAC' },
            'TR': { name: 'Turkey', flag: 'üáπüá∑', gdp: '$1,110B', potential: 'Mature', mandate: '2014', status: 'Active', model: 'Clearance (GIB)', region: 'MENA' },
            'IT': { name: 'Italy', flag: 'üáÆüáπ', gdp: '$2,250B', potential: 'High', mandate: '2019', status: 'Active', model: 'Clearance (SdI)', region: 'EU' },
            'IN': { name: 'India', flag: 'üáÆüá≥', gdp: '$3,730B', potential: 'Very High', mandate: '2020', status: 'Active', model: 'Clearance (GST)', region: 'APAC' },
            'SA': { name: 'Saudi Arabia', flag: 'üá∏üá¶', gdp: '$1,070B', potential: 'Very High', mandate: '2021-2026', status: 'Active', model: 'FATOORA', region: 'MENA' },
            'VN': { name: 'Vietnam', flag: 'üáªüá≥', gdp: '$450B', potential: 'High', mandate: '2022', status: 'Active', model: 'Clearance', region: 'APAC' },
            'RO': { name: 'Romania', flag: 'üá∑üá¥', gdp: '$350B', potential: 'High', mandate: 'Jan 2024', status: 'Active', model: 'RTIR', region: 'EU' },
            'DE': { name: 'Germany', flag: 'üá©üá™', gdp: '$4,520B', potential: 'Very High', mandate: '2025-2028', status: 'Phased', model: 'Flexible (EN 16931)', region: 'EU' },
            'MY': { name: 'Malaysia', flag: 'üá≤üáæ', gdp: '$430B', potential: 'High', mandate: 'Jul 2025', status: 'Active', model: 'MyInvois', region: 'APAC' },
            'SG': { name: 'Singapore', flag: 'üá∏üá¨', gdp: '$500B', potential: 'High', mandate: 'Nov 2025', status: 'Active', model: 'Peppol', region: 'APAC' },
            'CN': { name: 'China', flag: 'üá®üá≥', gdp: '$17,960B', potential: 'Very High', mandate: 'Late 2025', status: 'Active', model: 'Golden Tax', region: 'APAC' },
            'ID': { name: 'Indonesia', flag: 'üáÆüá©', gdp: '$1,390B', potential: 'Very High', mandate: '2025-2026', status: 'Active', model: 'Coretax', region: 'APAC' },
            'BE': { name: 'Belgium', flag: 'üáßüá™', gdp: '$630B', potential: 'High', mandate: 'Jan 2026', status: 'Pending', model: 'Peppol', region: 'EU' },
            'PL': { name: 'Poland', flag: 'üáµüá±', gdp: '$750B', potential: 'High', mandate: 'Feb 2026', status: 'Pending', model: 'KSeF', region: 'EU' },
            'AE': { name: 'UAE', flag: 'üá¶üá™', gdp: '$500B', potential: 'High', mandate: 'Jul 2026', status: 'Pending', model: 'Clearance', region: 'MENA' },
            'OM': { name: 'Oman', flag: 'üá¥üá≤', gdp: '$115B', potential: 'Medium', mandate: 'Aug 2026', status: 'Pending', model: 'Peppol 5-corner', region: 'MENA' },
            'FR': { name: 'France', flag: 'üá´üá∑', gdp: '$3,030B', potential: 'Very High', mandate: 'Sep 2026', status: 'Pending', model: 'Hybrid (PPF+PDP)', region: 'EU' },
            'PH': { name: 'Philippines', flag: 'üáµüá≠', gdp: '$440B', potential: 'High', mandate: 'Dec 2026', status: 'Pending', model: 'CTC (EIS)', region: 'APAC' },
            'ES': { name: 'Spain', flag: 'üá™üá∏', gdp: '$1,580B', potential: 'Very High', mandate: '2027', status: 'Pending', model: 'Verifactu', region: 'EU' },
            'TH': { name: 'Thailand', flag: 'üáπüá≠', gdp: '$510B', potential: 'High', mandate: '2027-2028', status: 'Planned', model: 'TBD', region: 'APAC' },
            'NL': { name: 'Netherlands', flag: 'üá≥üá±', gdp: '$1,090B', potential: 'High', mandate: 'Jul 2030', status: 'Planned (ViDA)', model: 'Peppol', region: 'EU' },
            'SE': { name: 'Sweden', flag: 'üá∏üá™', gdp: '$590B', potential: 'High', mandate: 'Jul 2030', status: 'Planned (ViDA)', model: 'Peppol', region: 'EU' },
            'JP': { name: 'Japan', flag: 'üáØüáµ', gdp: '$4,230B', potential: 'Very High', mandate: 'QIS 2023', status: 'Voluntary (QIS)', model: 'Peppol', region: 'APAC' },
            'AU': { name: 'Australia', flag: 'üá¶üá∫', gdp: '$1,720B', potential: 'High', mandate: 'Voluntary', status: 'Voluntary', model: 'Peppol', region: 'APAC' },
            'EG': { name: 'Egypt', flag: 'üá™üá¨', gdp: '$400B', potential: 'High', mandate: '2020-2025', status: 'Active', model: 'ETA Clearance', region: 'MENA' },
            'JO': { name: 'Jordan', flag: 'üáØüá¥', gdp: '$50B', potential: 'Low', mandate: 'Apr 2025', status: 'Active', model: 'JoFotara', region: 'MENA' },
            'NG': { name: 'Nigeria', flag: 'üá≥üá¨', gdp: '$475B', potential: 'High', mandate: 'Nov 2025', status: 'Pending', model: 'Clearance', region: 'Africa' },
            'ZA': { name: 'South Africa', flag: 'üáøüá¶', gdp: '$400B', potential: 'High', mandate: 'TBD', status: 'Planned', model: 'TBD', region: 'Africa' },
            'US': { name: 'United States', flag: 'üá∫üá∏', gdp: '$27,360B', potential: 'Very High', mandate: 'Voluntary', status: 'Voluntary', model: 'DBNAlliance', region: 'Americas' },
            'GB': { name: 'United Kingdom', flag: 'üá¨üáß', gdp: '$3,340B', potential: 'High', mandate: 'B2G Active', status: 'Voluntary', model: 'Peppol', region: 'EU' },
            'CA': { name: 'Canada', flag: 'üá®üá¶', gdp: '$2,140B', potential: 'High', mandate: 'Voluntary', status: 'Voluntary', model: 'None', region: 'Americas' }
        };

        let selected = [];

        function initCompare() {
            const grid = document.getElementById('countryGrid');
            Object.keys(countryData).forEach(code => {
                const c = countryData[code];
                const btn = document.createElement('button');
                btn.className = 'country-btn';
                btn.id = `cb-${code}`;
                btn.innerHTML = `<span class="flag">${c.flag}</span>${c.name}`;
                btn.onclick = () => toggleSelect(code);
                grid.appendChild(btn);
            });
        }

        function toggleSelect(code) {
            const btn = document.getElementById(`cb-${code}`);
            if (selected.includes(code)) {
                selected = selected.filter(c => c !== code);
                btn.classList.remove('selected');
            } else if (selected.length < 5) {
                selected.push(code);
                btn.classList.add('selected');
            }
            document.getElementById('countBadge').textContent = `${selected.length} selected`;
        }

        function clearCompare() {
            selected.forEach(code => document.getElementById(`cb-${code}`).classList.remove('selected'));
            selected = [];
            document.getElementById('countBadge').textContent = '0 selected';
            document.getElementById('emptyCompare').style.display = 'block';
            document.getElementById('compareResult').classList.remove('active');
        }

        function preset(type) {
            clearCompare();
            const presets = {
                'brics': ['BR', 'IN', 'CN', 'ZA', 'SA'],
                'eu': ['DE', 'FR', 'IT', 'ES', 'PL'],
                'apac': ['CN', 'JP', 'IN', 'SG', 'ID'],
                'mena': ['SA', 'AE', 'EG', 'TR', 'OM']
            };
            presets[type].forEach(code => { if (countryData[code]) toggleSelect(code); });
        }

        function runCompare() {
            if (selected.length < 2) { alert('Select at least 2 countries'); return; }
            document.getElementById('emptyCompare').style.display = 'none';
            document.getElementById('compareResult').classList.add('active');
            renderCompare();
            renderInsights();
        }

        function renderCompare() {
            const container = document.getElementById('compareCards');
            container.style.gridTemplateColumns = `repeat(${Math.min(selected.length, 3)}, 1fr)`;
            container.innerHTML = selected.map(code => {
                const c = countryData[code];
                const statusClass = c.status.includes('Active') ? 'status-active' : c.status.includes('Phased') ? 'status-phased' : c.status.includes('Pending') ? 'status-pending' : c.status.includes('Voluntary') ? 'status-voluntary' : 'status-planned';
                const potClass = c.potential === 'Very High' ? 'potential-very-high' : c.potential === 'High' ? 'potential-high' : c.potential === 'Mature' ? 'potential-mature' : c.potential === 'Medium' ? 'potential-medium' : 'potential-low';
                return `
                <div class="compare-card">
                    <div class="compare-card-header">
                        <span class="flag">${c.flag}</span>
                        <span class="name">${c.name}</span>
                        <button class="remove" onclick="removeCard('${code}')">√ó</button>
                    </div>
                    <div class="compare-card-body">
                        <div class="info-section">
                            <div class="info-section-title">Overview</div>
                            <div class="info-row"><span class="info-label">GDP</span><span class="info-value">${c.gdp}</span></div>
                            <div class="info-row"><span class="info-label">Potential</span><span class="info-value"><span class="potential ${potClass}">${c.potential}</span></span></div>
                            <div class="info-row"><span class="info-label">Region</span><span class="info-value">${c.region}</span></div>
                        </div>
                        <div class="info-section">
                            <div class="info-section-title">E-Invoice Mandate</div>
                            <div class="info-row"><span class="info-label">Mandate Date</span><span class="info-value">${c.mandate}</span></div>
                            <div class="info-row"><span class="info-label">Status</span><span class="info-value"><span class="status ${statusClass}">${c.status}</span></span></div>
                            <div class="info-row"><span class="info-label">Model</span><span class="info-value">${c.model}</span></div>
                        </div>
                    </div>
                </div>`;
            }).join('');
        }

        function renderInsights() {
            const list = document.getElementById('insightList');
            const data = selected.map(c => countryData[c]);
            const insights = [];

            const active = data.filter(c => c.status.includes('Active'));
            if (active.length) insights.push({ icon: '‚úÖ', title: 'Active Mandates', text: `${active.map(c=>c.name).join(', ')} have active e-invoicing.` });

            const veryHigh = data.filter(c => c.potential === 'Very High');
            if (veryHigh.length) insights.push({ icon: 'üî•', title: 'Very High Potential', text: `${veryHigh.map(c=>c.name).join(', ')} are top-tier markets.` });

            const mature = data.filter(c => c.potential === 'Mature');
            if (mature.length) insights.push({ icon: 'üìä', title: 'Mature Markets', text: `${mature.map(c=>c.name).join(', ')} have established compliance but value-add opportunities exist.` });

            const peppol = data.filter(c => c.model.includes('Peppol'));
            if (peppol.length) insights.push({ icon: 'üåê', title: 'Peppol Adopters', text: `${peppol.map(c=>c.name).join(', ')} use Peppol.` });

            const clearance = data.filter(c => c.model.includes('Clearance') || c.model.includes('CTC'));
            if (clearance.length) insights.push({ icon: 'üìã', title: 'Clearance/CTC Model', text: `${clearance.map(c=>c.name).join(', ')} use clearance models.` });

            const totalGdp = data.reduce((sum, c) => sum + parseFloat(c.gdp.replace(/[^0-9.]/g, '')), 0);
            insights.push({ icon: 'üí∞', title: 'Combined GDP', text: `$${totalGdp.toLocaleString()}B total GDP across selected countries.` });

            list.innerHTML = insights.map(i => `
                <div class="insight-item">
                    <div class="insight-item-title">${i.icon} ${i.title}</div>
                    <div class="insight-item-text">${i.text}</div>
                </div>
            `).join('');
        }

        function removeCard(code) {
            toggleSelect(code);
            if (selected.length < 2) {
                document.getElementById('emptyCompare').style.display = 'block';
                document.getElementById('compareResult').classList.remove('active');
            } else {
                renderCompare();
                renderInsights();
            }
        }

        function showMainSection(id) {
            document.querySelectorAll('.main-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.target.classList.add('active');
        }

        function filterTable() {
            const filter = document.getElementById('searchBox').value.toLowerCase();
            const rows = document.getElementById('masterTable').getElementsByTagName('tr');
            for (let i = 1; i < rows.length; i++) {
                const cells = rows[i].getElementsByTagName('td');
                let found = false;
                for (let j = 0; j < cells.length; j++) {
                    if (cells[j].textContent.toLowerCase().includes(filter)) { found = true; break; }
                }
                rows[i].style.display = found ? '' : 'none';
            }
        }

        function showRegion(region) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(region).classList.add('active');
        }

        initCompare();
    </script>
</body>
</html>
